name: Update Project Field on Issue/PR Closed

on:
  workflow_call:
    inputs:
      project_name:
        description: 'Name of the Project which tracks completed sprints'
        type: 'string'
        required: true
      field_name:
        description: 'Name of the Field in the project to update'
        type: 'string'
        required: false
        default: 'CompletedSprint'

jobs:
  update_completed_sprint:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: 16
      - run: npm ci
        working-directory: ./update-completed-sprint-on-issue-closed
      - name: Update the completed sprint
        id: update_completed_sprint
        uses: actions/github-script@v5
        working-directory: ./update-completed-sprint-on-issue-closed
        with:
          script: |
            const script = require('./dist/index.js');
            await script();
